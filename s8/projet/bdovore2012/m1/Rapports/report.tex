\documentclass[11pt]{report} % { book | article | report }
% -------------------- Langue --------------------
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[frenchb,english]{babel}
% -------------------- Marges, interlignes--------------------
\usepackage[a4paper]{geometry}	% 
%\usepackage{setspace}
%\usepackage{layout}		% Layout
%\usepackage{lscape}		% Orientation de la page
% -------------------- Soulignement --------------------
%\usepackage{soul}
%\usepackage{ulem}
% -------------------- Fontes --------------------
%\usepackage{eurosym}		% Symbole Euro
%\usepackage{bookman}
%\usepackage{charter}
%\usepackage{newcent}
\usepackage{lmodern}
%\usepackage{mathpazo}					
%\usepackage{mathptmx}
% -------------------- Code et citations --------------------
%\usepackage{verbatim}		% Code
%\usepackage{listings}		% Code avec coloration syntaxique
%\usepackage{url}		% Urls
%\usepackage{moreverb}
% -------------------- Couleur --------------------
%\usepackage{color}		% les couleurs
%\usepackage{colortbl}		% les couleurs dans un tableau
%\usepackage[svgnames]{xcolor}	% le package color, en mieux !
% -------------------- Maths --------------------
%\usepackage{amsmath}
%\usepackage{amssymb}
%\usepackage{mathrsfs}
%\usepackage{asmthm}
% -------------------- Images --------------------
\usepackage{graphicx}		% Insertion d'images ou de pdf -> option : [pdftex]
%\usepackage{wrapfig}		% Insérer des images dans un paragraphe
% -------------------- Tableau --------------------
\usepackage{multirow}		% Fusion de cellules sur plusieurs lignes -> multirow{nblign}{size}{texte}
% -------------------- Autres --------------------
%\usepackage{makeidx}		% Création d'index
%\usepackage{fancyhdr}		% Personnalisation des entetes
%\usepackage{sfheaders}		% Mise sans-serif des titres
%\usepackage{enumitem}		% Personnalisation des environnement enumerate	
%\usepackage{pdfpages}
%\usepackage[nottoc, notlof, notlot]{tocbibind}
\usepackage{tocvsec2}		% Donne le choix du départ de la numérotation
\usepackage[toc,page]{appendix} % Utilisation d'annexes

% -- Avec le package listings
% \lstset{language=java}
% -- Avec le package tocvsec2 (dans le document)
% \maxsecnumdepth{chapter}

\include{utils}
 
\newcommand{\imgpath}[1]{images/#1}
\newcommand{\txtimp}[1]{\textbf{#1}}

\begin{document}
\include{cover_first}
\newpage
\tableofcontents
\newpage

\maxsecnumdepth{part}
\chapter{Introduction}
Managing a library can be hard, especially for collectors, who could possess hundreds of books. That is why websites like BDovore\footnote{www.bdovore.com} have been created. BDovore is specialized in comic books and allows its users to manage their library online. But because we are not always connected to the Internet, UFR ST and BDovore started a project : create a software, based on the Java language, that you could use offline on your computer and that would providing the same functionalities as the website.

In this report, we will talk about our contributions in this project. In a first part, we will explore the software with the user's point of view and see what are the actual implemented features. Then, we will present our work on these features, to reinforce them or to make them better. Finally, we will see the totally new features that we have added, before concluding.

\setsecnumdepth{subsection}
\chapter{The Software}
In this chapter, we will present the software with the user's point of view. We will, in one part, list the achieved functionalities which are yet implemented. Next, we will talk about the unachieved one and so what will be our future contributions.

\section{The features}
\subsection{Searching an album}
As the user will need to find the albums he owns in the software, a research function was necessary. Really basic, it was only using a single keyword and the user had to take care of capital letters and other special characters, as accents. By example, the research ''asterix`` did not give any result, in contrary to ''Astérix``.\\
The results are displayed in a list with the title, the tome number, the series, the genre and the ISBN (a unique numeric book identifier). A double click shows a window with details about the album.\\
If your research has a lot of result, four buttons are available in the bottom of the list to go to the first, previous, next or last page.



\subsection{Add or remove an album oh the user library}
Once the window has appear after a double click, some check-boxes are displayed. To add an album, the user has to check the box named ''Owned``. Then three check-boxes become available for details, which enable the user to notice if the album is dedicated, lent or if he predicts to buy it later.

\subsection{See statistics}
Once the user library is filled up, he can see some statistics on that library. There are two types of statistics : the first type, on the top, is displaying amounts of album of each type (albums in the library, owned and to buy). The second one shows percentages of genres, editors, scriptwriters or cartoonists.

\subsection{Configure the software}
Finally, a configuration tool is provided for setting a proxy server or to connect the user on its website's account (which allow him to synchronize his library with the online one).

% Capture d'écran
\begin{figure}[!ht]
\begin{center}
\includegraphics[height=9cm]{\imgpath{screenshot.png}}
\caption{A screenshot of the software. You can get details of a volume by double clicking on it}
\end{center}
\end{figure}
%

\section{Unachieved functionalities}
\subsection{Update the research base}
The research feature is working with a database of all the albums which are listed on the website. To keep it to date, a feature that download all the new albums on the website was planned but previous groups did not have the time to finish it.

\subsection{Synchronizing user account}
As user can suggest albums on the website or changes details of the albums on the software, the synchronizing feature had to get the two libraries, search the differences between them and update them. For ambiguous cases, a window shows the differences and asks user to decide whether the online one or the offline one is the more up to date. All the reflections on the feature were done but were not integrated in the software.

\section{Our contributions}
For the time we had to work on this project, our main goal was to finish to put in place some unachieved functionalities. In this purpose, we had to:
\begin{itemize}
\item Change the \txtimp{research tool}, to make it more efficient and intuitive, so the user could write its requests like in any search engine : the user would be able to make a request with several words in any orders and without caring about accents or syntax. He could also use some special characters and keywords to specify its research (like the ''*`` joker or the double quotes).
\item Write the \txtimp{web service}'s functions. It was a necessary step to do before taking care of the synchronization part. Indeed, the web service is the key between the both databases and it will permit to get the informations in them, like the comic books that the user owns or the details about a volume.
\item As we see, a certain reflection was done about the \txtimp{synchronization} by the previous students groups who worked on this project. Our role in this part was to make the reflection become real and so finishing a big feature of the software. So we had to make the mechanisms which would resolve the eventual conflicts between the online and offline libraries of the user and make them the same.
\item Finally, all along the time we worked on the software, we have done some \txtimp{minor adjustments} (for example for the ergonomics of the Graphic User Interface).

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%	CHAPTER 2 - REINFORCING THE SOFTWARE
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Reinforcing the software}
Before any modifications on the software, we had to discover how this one was built. It was necessary to see where we would add our functionalities and, eventually, where we would have to make modifications before any additions.

\section{Understanding previous students work}
Working on a software with a substantial base coded by other people is a pretty difficult exercise. That's why before any reflections, we had to appropriate the architecture and the code. Even if it could take a lot of time, this is not a waste : it's important to see where exactly we would add our modifications and if these modifications would be immediately possible. \newline
This preliminary step was particularly difficult on this project. Indeed, two groups of students worked on it at the same time the last year, so we had to discover the work of both. Furthermore, it was the first time for us that we had to work on a software with such an architecture : embedded database, web service (coded with the web-oriented language PHP) and distant database (the one of the website).\newline
After watching the source code of the two actual programs and read the documentations left by the students, we quickly understand that :

\begin{itemize}
\item One of the group had totally remake the organisation of the local database (cf annexes for schemas of the previous and the actual databases).
\item The other group works especially on the synchronization part. They reflected on the conflicts that the user could have if certain informations are different between the website and the software (example : a volume is in the user's library on the website, but not in the program).
\item They thought of the function that the web service must have ... but don't write them !
\end{itemize}

That's why we saw that a complete review of the software would be necessary before anything else.

\section{Laying the foundation}
First of all, we decided to unify the two different projects in an only one. To work on this, we had to install our work environment :

\begin{itemize}
\item A collaboration system (Subversion). Not necessary, but very useful. It permits to store the projects online (and work on them with any computer) and handle the different versions of the project (if the last version didn't work -for example - we still could come back to a previous one).
\item A web server on the local computer, to ''simulate`` the server of the website. We stored on it a copy of the database of BDOvore in order to test our future web service.
\item The embedded database that we could generate with some commands.
\end{itemize}

So we could finally work on the project. To unify the two versions, the main work was to adapt the functions which use the embedded base (with the SQL language) to the new model of this database and check every of them, so the software could -simply- work. To be sure of our work, we tested all the new requests to the database out of the software, directly on it (to be sure, in case of an error, that the mistake is really in the request and not in another place of the program).

The software with the contributions of the two previous groups was finally unified. We could now testing the actual features and their efficiency.

\section{Software trials and updates}
Our first observation was that the search engine (the tool who allows to find a specific volume in the user's library or in the volumes referenced in the website) was functional but very limited. In fact, the research gave you results which fit perfectly with the syntax of what you search. As we saw in the introduction, typing a research with the keyword ''asterix`` won't give you any results with the word ''Astérix`` because of the capital letter and the accent that the search engine didn't know how to ignore. 
\newline\newline To fix this problem, we decided to update the search engine (Lucene, an external search engine that you can use with many programming language) to its new version. This one was improved and allows many new possibilities, like the use of a joker character (''*``) or the use of some keywords like AND, OR or NOT to precise our research. It allows too to fix the problems of accents or capital letters.
\newline\newline Furthermore, we noticed some things we already knew : the synchronization tool doesn't work, so the base of referenced books was nearly empty (except for some entries that was inserted manually to test the search engine) as the library of the user.
\newline\newline Finally, while we was at it, we updated the database engine (''H2`` the one which is used to the embedded base) in the purpose to increase the performance and the rapidity of the recovery of the data. Additionally, we brought some minors modifications on the GUI (Graphic User Interface, what the user use to communicate with the program, like the buttons or the text fields) and in the code.
\newline As we see, we did an important work to improve the functionalities which was still implemented in the program, in the purpose to make it more user-friendly, efficient and stable.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%	CHAPTER 3 - WEBSERVICE AND SYNCHRO
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Web service and Synchronization}
In this part, we will focus on our biggest addition on the software : the mechanisms for the synchronization of the library of the user, both in the software and on the website, and, for that, focus on the creation of the web service (and, before, what exactly a web service is), then, on the synchronization of the local database.

\section{What is a web service?}

The first question we had to give an answer was : what exactly a web service is ? In fact, we had never approach such a concept before this project.
After researches, we learned that a web service is an application, running on a server, which allows communication between other programs, without caring about the languages or the technology they are made with. It makes public a list of functions that these programs can use : it's a kind of layer between the client (the application which will use the web service) and the server.
\newline For example, Google provides a web service that anybody can call in its own application. With it, you can for example incorporate the search engine or use its speller.

%
% Schema
%
\begin{figure}[!ht]
\begin{center}
\includegraphics[height=7cm]{\imgpath{WebserviceSchema.png}}
\caption{How a webservice work - very simplified !}
\end{center}
\end{figure}


\section{Why do we need it?}

In our case, we had to write a web service to enable interactions between the website and the software. Theses interactions consist of getting data on BDOvore : the list of the referenced albums on the website, their details (authors, genres, ...) or the current user's library with all its informations (if some albums are lent or dedicated, ...). The web service had to be able to do modifications on the web service (for example, if the user add an album in the software, it must be reported on his online account).
\newline A list of functions was still written in the WSDL file (a file who listed all the functions of the web service that the clients can use) by the previous groups, but weren't particularly useful in our point of view.
\newline Our work was finally to completely rewrite the functions of the web service. We wrote it in the PHP language, because of its facility to work with a database and because it's compatible with the most of web servers.
\newline For such a small development, we could think that a web service is not necessary. In fact, it was ''just`` advisable for some reasons:

\begin{itemize}
\item Simplifying the development, with the PHP language 
\item With it, if the server change (for example, modifications in the structure of the web site's database), we won't have to modify the client (the software), but just the code of the web service. It's more handy for the future users (who won't have to update their software) and the developers. 
\end{itemize}

With finishing the web service, we were now able to get all the data we need from the website to use them in the software, via the synchronization tool.

\section{The synchronization}
As we told before, the synchronization is the mechanism which will certify the consistency of the data in the software and in the website. It is divided in two parts : the synchronization of the whole list of albums referenced and the one of the user library.
\newline For the first one, the problem was to avoid to download at every start of the program the more than 120.000 volumes (and their informations) that the website counts, because of the time it takes to do it. We solved this problem by only downloading the new volumes that was added on the website since the last time we launched the program (thanks to a comparison between the identifiers - a number which guarantee the uniqueness of a volume in a base - in the two bases).
\newline For example : if the biggest identifier for a volume in the embedded database is ''120``, we will download every volumes in the website's database with an identifier superior to 120.
\newline The second one was harder to handle, but one of the previous groups greatly simplified the task. The problem was to know what to do if there are differences between the libraries of the user in the program and in the website. These students prepared a table with every cases which could arrive and we used it to write the functions for the synchronization. We just added some cases they didn't think about (for the table, cf annexes).
\newline After that work, it's now possible :
\begin{itemize}
\item To download the list of the new volumes available on the website and visualizing the progression of the update.
\item To show the conflicts existing in the two libraries and asking to the user to solve them : he can now decide which informations he want to keep.
\end{itemize}

\setsecnumdepth{part}
\chapter{Conclusion}
As we see, working on a project which was began and continued by a lot of students is not a simple thing. That fact justified the time we spent to analyse and to understand the architecture and programming of this software. Thanks to this analysis, we have been able to improved some features (like the search engine) and added new one (communication with the website). 
\newline At this point, the software is pretty functional : the user can search books, get details about them, get his library from the website, manage it from the program and keep the modifications of the both supports.
\newline Unfortunately, we hadn't got enough time to put final touches on our work. We wanted to make unit tests (testing every possibilities for our functions) on our new features, in order to make them more stable. We wanted too do some tests on the synchronization (the part where the software get the informations for the search engine) to make it faster, because at the first launch, it takes a lot of time.
\newline Furthermore, we can imagine features which could be implemented:
\begin{itemize}
\item If we have a book which is not referenced, it would be nice to have the possibility to add manually one in the software and finally integrate it in the website (this feature still exists on the website).
\item There's a lot of possibility to improve the ergonomics of the graphic interface and make the software more user friendly : add a book in our library with one click, add several books at once, scan the bar code of the comic ...
\item We could also add a system which could to inform you of a freshly release of a book and propose to you to purchase it.
\end{itemize}


\selectlanguage{frenchb}
\setsecnumdepth{subsection}
\begin{appendices}
\include{rapport}
\end{appendices}

\selectlanguage{english}
\include{cover_fourth}


\end{document}

